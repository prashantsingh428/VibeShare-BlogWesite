<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head') %>
        <style>
            body {
                background-color: #f8fafc;
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            }

            .profile-card {
                background: white;
                border-radius: 16px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            }

            .btn-primary {
                background: #1e293b;
                color: white;
                border-radius: 8px;
                padding: 12px 24px;
                font-weight: 500;
                transition: all 0.2s;
            }

            .btn-primary:hover {
                background: #0f172a;
            }

            .btn-outline {
                background: white;
                border: 1px solid #e2e8f0;
                color: #475569;
                border-radius: 8px;
                padding: 12px 24px;
                font-weight: 500;
                transition: all 0.2s;
            }

            .btn-outline:hover {
                background: #f8fafc;
                border-color: #cbd5e1;
            }

            .form-input {
                width: 100%;
                padding: 12px 16px;
                border-radius: 10px;
                background: #f8fafc;
                border: 1px solid #e2e8f0;
                color: #334155;
                font-size: 14px;
                transition: all 0.2s;
            }

            .form-input:focus {
                outline: none;
                border-color: #94a3b8;
                box-shadow: 0 0 0 3px rgba(148, 163, 184, 0.1);
            }

            .form-input:read-only {
                background: #f1f5f9;
                color: #94a3b8;
                cursor: not-allowed;
            }

            .form-label {
                display: block;
                font-size: 13px;
                font-weight: 600;
                color: #475569;
                margin-bottom: 8px;
            }
        </style>
</head>

<body class="min-h-screen flex flex-col text-slate-800">

    <%- include('./partials/navbar') %>

        <div class="flex-grow max-w-2xl mx-auto px-4 sm:px-6 py-10 w-full">

            <!-- ================= EDIT PROFILE CARD ================= -->
            <div class="profile-card overflow-hidden">

                <!-- Header -->
                <div class="h-24 bg-slate-800 relative">
                    <div class="absolute inset-0 flex items-center justify-center">
                        <h1 class="text-2xl font-bold text-white">Edit Profile</h1>
                    </div>
                </div>

                <div class="px-8 py-8">

                    <!-- Current Profile Image -->
                    <div class="flex justify-center -mt-16 mb-8">
                        <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-lg bg-white">
                            <img src="<%= (user.profilepic && user.profilepic.startsWith('http')) ? user.profilepic : '/images/uploads/' + (user.profilepic || 'default.png') %>"
                                class="w-full h-full object-cover" alt="Profile">
                        </div>
                    </div>

                    <!-- Edit Profile Form -->
                    <form method="post" action="/profile/update" class="space-y-5">

                        <!-- Name Field -->
                        <div>
                            <label for="name" class="form-label">
                                <i class="ri-user-line mr-1"></i> Full Name
                            </label>
                            <input type="text" name="name" id="name" value="<%= user.name || '' %>" class="form-input"
                                placeholder="Enter your full name">
                        </div>

                        <!-- Username Field -->
                        <div>
                            <label for="username" class="form-label">
                                <i class="ri-at-line mr-1"></i> Username
                            </label>
                            <input type="text" name="username" id="username" value="<%= user.username || '' %>"
                                class="form-input" placeholder="Enter your username" required>
                        </div>

                        <!-- Email Field (Read-only) -->
                        <div>
                            <label for="email" class="form-label">
                                <i class="ri-mail-line mr-1"></i> Email
                            </label>
                            <input type="email" name="email" id="email" value="<%= user.email %>" class="form-input"
                                readonly>
                            <p class="text-xs text-slate-400 mt-2">Email cannot be changed</p>
                        </div>

                        <!-- Age Field -->
                        <div>
                            <label for="age" class="form-label">
                                <i class="ri-calendar-line mr-1"></i> Age
                            </label>
                            <input type="number" name="age" id="age" value="<%= user.age || '' %>" min="1" max="120"
                                class="form-input" placeholder="Enter your age">
                        </div>

                        <!-- Error/Success Message -->
                        <% if (typeof error !=='undefined' && error) { %>
                            <div
                                class="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg flex items-center gap-2 text-sm">
                                <i class="ri-error-warning-line"></i>
                                <span>
                                    <%= error %>
                                </span>
                            </div>
                            <% } %>

                                <% if (typeof success !=='undefined' && success) { %>
                                    <div
                                        class="bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg flex items-center gap-2 text-sm">
                                        <i class="ri-checkbox-circle-line"></i>
                                        <span>
                                            <%= success %>
                                        </span>
                                    </div>
                                    <% } %>

                                        <!-- Action Buttons -->
                                        <div class="flex flex-col sm:flex-row gap-3 pt-4">
                                            <button type="submit"
                                                class="btn-primary flex-1 flex items-center justify-center gap-2">
                                                <i class="ri-save-line"></i>
                                                <span>Save Changes</span>
                                            </button>
                                            <a href="/profile"
                                                class="btn-outline flex-1 flex items-center justify-center gap-2">
                                                <i class="ri-arrow-left-line"></i>
                                                <span>Cancel</span>
                                            </a>
                                        </div>

                    </form>

                </div>
            </div>

        </div>

        <%- include('./partials/footer') %>

</body>

</html>